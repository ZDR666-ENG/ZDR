<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>æˆ‘ä»¬çš„å‡è‚¥å°é˜Ÿ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{--bg:#fff;--text:#333;--primary:#ff6b6b}
    @media (prefers-color-scheme:dark){:root{--bg:#1e1e1e;--text:#ddd}}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;background:var(--bg);color:var(--text)}
    header{display:flex;align-items:center;justify-content:space-between;padding:0 1rem;background:var(--primary);color:#fff}
    nav{display:flex;gap:1rem}
    nav span{cursor:pointer;padding:.5rem 0;border-bottom:2px solid transparent}
    nav span.active{border-color:#fff}
    main{padding:1rem}
    section{display:none}
    section.active{display:block}
    .card{background:#f5f5f7;border-radius:8px;padding:1rem;margin-bottom:1rem}
    textarea{width:100%;resize:vertical}
    button{background:var(--primary);color:#fff;border:0;padding:.5rem 1rem;border-radius:4px;cursor:pointer}
    img{max-width:100%;border-radius:4px}
  </style>
</head>
<body>
  <header>
    <h1>ğŸ¯ æˆ‘ä»¬çš„å‡è‚¥åŸºåœ°</h1>
    <nav>
      <span class="tab active" data-page="home">é¦–é¡µ</span>
      <span class="tab" data-page="recipe">é£Ÿè°±</span>
      <span class="tab" data-page="sport">æ‰“å¡</span>
      <span class="tab" data-page="progress">è¿›åº¦</span>
      <span class="tab" data-page="chat">çŒæ°´</span>
    </nav>
  </header>

  <main>
    <!-- 1. é¦–é¡µ -->
    <section id="home" class="active">
      <div class="card">
        <h2>åŸºæœ¬åŸåˆ™</h2>
        <ol>
          <li>çœŸå®ç¬¬ä¸€ï¼šæ‹’ç»æ”€æ¯”ï¼Œåªæ±‚çœŸå®ã€‚</li>
          <li>é¼“åŠ±ä¸ºä¸»ï¼šä¸€ä¸ªäººçš„æˆåŠŸå°±æ˜¯å…¨é˜Ÿçš„æˆåŠŸï¼</li>
          <li>å¥åº·è‡³ä¸Šï¼šä¸ææç«¯èŠ‚é£Ÿã€‚</li>
        </ol>
        <h3>æœ¬å‘¨ç„¦ç‚¹ç›®æ ‡</h3>
        <p id="weeklyGoal">æ¯äººå®Œæˆ 2 æ¬¡è¿åŠ¨</p>
        <button onclick="editGoal()">ä¿®æ”¹ç›®æ ‡</button>
      </div>
    </section>

    <!-- 2. é£Ÿè°± -->
    <section id="recipe">
      <h2>ğŸ¥— å…±äº«é£Ÿè°±åº“</h2>
      <div id="recipeList"></div>
      <div class="card">
        <h3>æ–°å¢é£Ÿè°±</h3>
        <input id="rName" placeholder="èœå">
        <textarea id="rIngredient" placeholder="é£Ÿæ"></textarea>
        <textarea id="rStep" placeholder="åšæ³•"></textarea>
        <input id="rAuthor" placeholder="æä¾›è€…">
        <input type="file" id="rPic" accept="image/*">
        <button onclick="addRecipe()">å‘å¸ƒ</button>
      </div>
    </section>

    <!-- 3. æ‰“å¡ -->
    <section id="sport">
      <h2>ğŸ’ª è¿åŠ¨æ‰“å¡åŒº</h2>
      <div id="sportList"></div>
      <div class="card">
        <textarea id="sContent" placeholder="ä»Šå¤©åšäº†ä»€ä¹ˆè¿åŠ¨ï¼Ÿ"></textarea>
        <button onclick="addSport()">æ‰“å¡</button>
      </div>
    </section>

    <!-- 4. è¿›åº¦ -->
    <section id="progress">
      <h2>ğŸ“ˆ è¿›åº¦è®°å½•å¢™</h2>
      <table id="progressTable" border="1" cellpadding="6">
        <thead><tr><th>å§“å</th><th>å½“å‰ä½“é‡</th><th>è¾ƒä¸Šå‘¨</th><th>æœ¬å‘¨å¿ƒå¾—</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="card">
        <input id="pName" placeholder="å§“å">
        <input id="pWeight" placeholder="ä½“é‡(kg)">
        <textarea id="pNote" placeholder="å¿ƒå¾—"></textarea>
        <button onclick="addProgress()">è®°å½•</button>
      </div>
    </section>

    <!-- 5. çŒæ°´ -->
    <section id="chat">
      <h2>ğŸ’¬ çŒæ°´é¼“åŠ±åŒº</h2>
      <div id="chatList"></div>
      <div class="card">
        <textarea id="cContent" placeholder="è¯´ç‚¹ä»€ä¹ˆé¼“åŠ±å¤§å®¶å§~"></textarea>
        <button onclick="addChat()">å‘é€</button>
      </div>
    </section>
  </main>

  <script>
    /* ===== è·¯ç”± ===== */
    document.querySelectorAll('.tab').forEach(el=>{
      el.onclick=e=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
        el.classList.add('active');
        document.getElementById(el.dataset.page).classList.add('active');
      }
    });

    /* ===== æœ¬åœ°å­˜å‚¨ ===== */
    const db=(key,def=[])=>JSON.parse(localStorage.getItem(key)||JSON.stringify(def));
    const save=(key,val)=>localStorage.setItem(key,JSON.stringify(val));

    /* ===== é¦–é¡µ ===== */
    function loadGoal(){
      const g=db('weeklyGoal','æ¯äººå®Œæˆ 2 æ¬¡è¿åŠ¨');
      document.getElementById('weeklyGoal').textContent=g;
    }
    function editGoal(){
      const g=prompt('æœ¬å‘¨ç„¦ç‚¹ç›®æ ‡ï¼š',db('weeklyGoal'));
      if(g){save('weeklyGoal',g);loadGoal();}
    }
    loadGoal();

    /* ===== é£Ÿè°± ===== */
    function renderRecipe(){
      const arr=db('recipe');
      const box=document.getElementById('recipeList');
      box.innerHTML=arr.map((r,i)=>`
        <div class="card">
          <h3>${r.name}</h3>
          <p><strong>é£Ÿæï¼š</strong>${r.ingredient}</p>
          <p><strong>åšæ³•ï¼š</strong>${r.step}</p>
          <p><strong>æä¾›è€…ï¼š</strong>${r.author}</p>
          ${r.pic?`<img src="${r.pic}">`:''}
          <button onclick="delRecipe(${i})">åˆ é™¤</button>
        </div>`).join('');
    }
    function addRecipe(){
      const r={
        name:document.getElementById('rName').value,
        ingredient:document.getElementById('rIngredient').value,
        step:document.getElementById('rStep').value,
        author:document.getElementById('rAuthor').value,
        pic:''
      };
      const file=document.getElementById('rPic').files[0];
      if(file){
        const reader=new FileReader();
        reader.onload=e=>{r.pic=e.target.result;saveList();};
        reader.readAsDataURL(file);
      }else{saveList();}
      function saveList(){
        const list=db('recipe');
        list.unshift(r);
        save('recipe',list);
        renderRecipe();
        ['rName','rIngredient','rStep','rAuthor','rPic'].forEach(id=>document.getElementById(id).value='');
      }
    }
    function delRecipe(i){const l=db('recipe');l.splice(i,1);save('recipe',l);renderRecipe();}
    renderRecipe();

    /* ===== æ‰“å¡ ===== */
    function renderSport(){
      const arr=db('sport');
      const box=document.getElementById('sportList');
      box.innerHTML=arr.map((s,i)=>`
        <div class="card">
          <small>${s.date}</small>
          <p>${s.content}</p>
          <button onclick="delSport(${i})">åˆ é™¤</button>
        </div>`).join('');
    }
    function addSport(){
      const v=document.getElementById('sContent').value.trim();
      if(!v)return;
      const list=db('sport');
      list.unshift({date:new Date().toLocaleString('zh-CN'),content:v});
      save('sport',list);
      document.getElementById('sContent').value='';
      renderSport();
    }
    function delSport(i){const l=db('sport');l.splice(i,1);save('sport',l);renderSport();}
    renderSport();

    /* ===== è¿›åº¦ ===== */
    function renderProgress(){
      const arr=db('progress');
      const tb=document.querySelector('#progressTable tbody');
      tb.innerHTML=arr.map((p,i)=>`
        <tr>
          <td>${p.name}</td>
          <td>${p.weight} kg</td>
          <td>${p.delta}</td>
          <td>${p.note}</td>
        </tr>`).join('');
    }
    function addProgress(){
      const name=document.getElementById('pName').value.trim();
      const weight=parseFloat(document.getElementById('pWeight').value);
      const note=document.getElementById('pNote').value.trim();
      if(!name||!weight)return;
      const list=db('progress');
      const last=list.find(x=>x.name===name);
      const delta=last?(weight-last.weight).toFixed(1):'--';
      list.unshift({name,weight,delta,note});
      save('progress',list);
      ['pName','pWeight','pNote'].forEach(id=>document.getElementById(id).value='');
      renderProgress();
    }
    renderProgress();

    /* ===== çŒæ°´ ===== */
    function renderChat(){
      const arr=db('chat');
      const box=document.getElementById('chatList');
      box.innerHTML=arr.map((c,i)=>`
        <div class="card">
          <small>${c.date} ${c.name}ï¼š</small>
          <p>${c.content}</p>
          <button onclick="likeChat(${i})">ğŸ‘ ${c.like||0}</button>
        </div>`).join('');
    }
    function addChat(){
      const v=document.getElementById('cContent').value.trim();
      if(!v)return;
      const name=prompt('æ˜µç§°ï¼š')||'åŒ¿å';
      const list=db('chat');
      list.unshift({date:new Date().toLocaleString('zh-CN'),name,content:v,like:0});
      save('chat',list);
      document.getElementById('cContent').value='';
      renderChat();
    }
    function likeChat(i){const l=db('chat');l[i].like=(l[i].like||0)+1;save('chat',l);renderChat();}
    renderChat();
  </script>
</body>
</html>
